"0","model <- lm(y~x)"
"0","model"
"1","
Call:
"
"1",""
"1","lm(formula = y ~ x)"
"1",""
"1","

"
"1","Coefficients:
"
"1","(Intercept)  "
"1","          x  "
"1","
"
"1","    40.7842  "
"1","     0.7656  "
"1","
"
"1","
"
"0","summary(model)"
"1","
Call:
"
"1",""
"1","lm(formula = y ~ x)"
"1",""
"1","

"
"1",""
"1","Residuals:
"
"1","    Min "
"1","     1Q "
"1"," Median "
"1","     3Q "
"1","    Max "
"1","
"
"1","-10.813 "
"1"," -5.629 "
"1"," -2.531 "
"1","  6.758 "
"1"," 12.234 "
"1","
"
"1","
Coefficients:
"
"1","           "
"1"," Estimate"
"1"," Std. Error"
"1"," t value"
"1"," Pr(>|t|)"
"1","   "
"1","
(Intercept)"
"1","  40.7842"
"1","     8.5069"
"1","   4.794"
"1","  0.00137"
"1"," **"
"1","
x          "
"1","   0.7656"
"1","     0.1750"
"1","   4.375"
"1","  0.00236"
"1"," **"
"1","
"
"1","---
Signif. codes:  "
"1",""
"1","0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1"
"1","
"
"1","
Residual standard error:"
"1"," "
"1","8.704"
"1"," "
"1","on"
"1"," "
"1","8"
"1"," "
"1","degrees of freedom"
"1","
"
"1","Multiple R-squared: "
"1"," "
"1","0.7052"
"1",",	Adjusted R-squared: "
"1"," "
"1","0.6684"
"1"," "
"1","
F-statistic:"
"1"," "
"1","19.14"
"1"," "
"1","on"
"1"," "
"1","1"
"1"," "
"1","and"
"1"," "
"1","8"
"1"," "
"1","DF,  p-value:"
"1"," "
"1","0.002365"
"1","
"
"1","
"
"0","aov(model) #analisis de varianza"
"1","Call:
   "
"1","aov(formula = model)
"
"1","
Terms:
"
"1","               "
"1","         x"
"1"," Residuals"
"1","
Sum of Squares "
"1"," 1449.9741"
"1","  606.0259"
"1","
Deg. of Freedom"
"1","         1"
"1","         8"
"1","
"
"1","
"
"1","Residual standard error:"
"1"," "
"1","8.703633"
"1","
"
"1","Estimated effects may be unbalanced
"
"0","########## estimacion de sigma cuadrada"
"0",""
"0","Scuad <- (SCy-b1*SCxy)/(n-2)"
"0","Scuad #varianza de los errores, o residual standar al cuadrado, esta en el summary de los models"
"1","[1]"
"1"," 75.75323"
"1","
"
"0","CV <- 100*sqrt(Scuad)/yprom"
"0","CV #debe estar cercano a 10"
"1","[1]"
"1"," 11.45215"
"1","
"
"0","#Inferencia sobre beta 1"
"0","#H_0: Beta_1=0 vs H_1: beta_1 diferente de 0"
"0",""
"0","alpha <-  0.05 #porque queremos estimar este alpha"
"0","df <- n-2 #Estamos estimando dos parametro, SON LOS GRADOS DE LIBERTAD. degrees of freedom"
"0","qti <- qt(alpha/2, df, lower.tai = TRUE ) #q de quantil de T de tstudent i de izquierdo"
"0","      #qt(probabilidad, grados de libertad, del lado izquierdo)"
"0","qti"
"1","[1]"
"1"," -2.306004"
"1","
"
"0","qtd <- qt(alpha/2, df, lower.tai = FALSE )"
"0","qtd"
"1","[1]"
"1"," 2.306004"
"1","
"
"0","S <- sqrt(Scuad)"
"0",""
"0","tc <- b1/(S/sqrt(SCx))"
"0","tc"
"1","[1]"
"1"," 4.375015"
"1","
"
"0","#VAS A RECHAZAR H0 PORQUE EL MODELO NO ES INDEPENDIENTE"
"0",""
"0",""
"0",""
"0","# Region de rechazo"
"0","if(abs(tc)>qtd){"
"0","  print(""Rechazamos H0, es decir, b1 es diferente de b0"")"
"0","  }else{"
"0","  print(""No existe evidencia para rechazar H0"")"
"0","  }"
"1","[1]"
"1"," ""Rechazamos H0, es decir, b1 es diferente de b0"""
"1","
"
"0","pvalor <- 2*pt(-abs(tc),df)"
"0","pvalor"
"1","[1]"
"1"," 0.002364532"
"1","
"
"0","if(pvalor < alpha){"
"0","  print(""Rechzamos H0, es decir, b1 es diferente de b0"")"
"0","}else{"
"0","  print(""No existe evidencia para rechazar H0"")"
"0","}"
"1","[1]"
"1"," ""Rechzamos H0, es decir, b1 es diferente de b0"""
"1","
"
"0","##########Intervalo de confianza para B1"
"0","b1-qtd*S/sqrt(SCx) #Limite inferior"
"1","[1]"
"1"," 0.3620458"
"1","
"
"0","b1+qtd*S/sqrt(SCx) #Limite superior"
"1","[1]"
"1"," 1.169078"
"1","
"
"0","r <- SCxy / sqrt(SCx*SCy)"
"0","r"
"1","[1]"
"1"," 0.8397859"
"1","
"
"0","cor(x,y) ^ 2 #Calcular el coeficiente de correlacion, en el summary esta al cuadrado"
"1","[1]"
"1"," 0.7052403"
"1","
"
"0","#para conocer la correlacion real es sin el cuadrado, 0-4 baja, 4-6 media, 6-10 alta"
"0",""
"0","#Ajusted r cuadrada es el coeficiente de determinacion  "
"0",""
"0",""
"0","###intervalos de confianza"
"0",""
"0","erroryprom <- S*sqrt( (1/n)  +  (x-xprom)^2 / SCx ) "
"0","erroryprom"
"1"," [1]"
"1"," 3.012589"
"1"," 2.801946"
"1"," 5.168429"
"1"," 4.182836"
"1"," 3.358618"
"1"," 2.757887"
"1"," 4.182836"
"1"," 5.772913"
"1"," 3.461873"
"1"," 2.945782"
"1","
"
"0","errorpredic <- S*sqrt( 1  +  (1/n)  +  (x-xprom)^2 / SCx ) "
"0","errorpredic"
"1"," [1]"
"1","  9.210262"
"1","  9.143530"
"1"," 10.122544"
"1","  9.656570"
"1","  9.329177"
"1","  9.130125"
"1","  9.656570"
"1"," 10.444125"
"1","  9.366846"
"1","  9.188627"
"1","
"
"0","lipromy <- recta - qtd*erroryprom"
"0","lspromy <- recta + qtd*erroryprom"
"0","lipromy"
"1"," [1]"
"1"," 63.69403"
"1"," 67.24202"
"1"," 44.94253"
"1"," 80.13448"
"1"," 76.67619"
"1"," 70.40586"
"1"," 52.57425"
"1"," 84.88893"
"1"," 58.83016"
"1"," 73.80038"
"1","
"
"0","lspromy"
"1"," [1]"
"1","  77.58811"
"1","  80.16461"
"1","  68.77937"
"1","  99.42575"
"1","  92.16617"
"1","  83.12526"
"1","  71.86552"
"1"," 111.51365"
"1","  74.79635"
"1","  87.38636"
"1","
"
"0","#es como una curva de promedio de errores"
"0","  "
"0",""
"0","lipredic <- recta - qtd*errorpredic"
"0","lspredic <- recta + qtd*errorpredic"
"0","lipredic"
"1"," [1]"
"1"," 49.40217"
"1"," 52.61830"
"1"," 33.51833"
"1"," 67.51202"
"1"," 62.90806"
"1"," 55.71146"
"1"," 39.95180"
"1"," 74.11710"
"1"," 45.21327"
"1"," 59.40436"
"1","
"
"0","lspredic"
"1"," [1]"
"1","  91.87997"
"1","  94.78833"
"1","  80.20358"
"1"," 112.04820"
"1"," 105.93430"
"1","  97.81967"
"1","  84.48798"
"1"," 122.28549"
"1","  88.41324"
"1"," 101.78238"
"1","
"
"0","#agarra el error de todos los puntos"
"0",""
"0","plot(x,y, col=""blue"") #grafica los puntos"
